<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Login / Registro ‚Äî Pastas Nonna</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body{background:#f5f6f7;font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif}
    .flag{height:8px;background:linear-gradient(90deg,#009246 33%,#fff 33% 66%,#ce2b37 66%)}
    .hero{background:#fff;border:1px solid #e5e5e5;border-radius:12px}
    .tab-btn{border:1px solid #e5e5e5;background:#fff}
    .tab-btn.active{border-color:#009246;color:#009246;font-weight:600}
    footer{background:#fff;border-top:1px solid #e5e5e5;padding:20px 0;margin-top:24px}
    #toastArea{position:fixed;top:16px;right:16px;z-index:1080}
    @media (max-width:576px){#toastArea{left:16px;right:16px}}
  </style>
</head>
<body>
  <div class="flag"></div>

  <div class="container py-3">
    <!-- Encabezado -->
    <div class="d-flex justify-content-between align-items-center mb-3">
      <strong class="fs-5">Pastas Nonna</strong>
      <div class="d-flex gap-2">
        <a href="catalogo.html" class="btn btn-outline-secondary btn-sm">‚Üê Volver al cat√°logo</a>
        <a href="admin.html" class="btn btn-outline-secondary btn-sm">Admin</a>
      </div>
    </div>

    <!-- Tabs -->
    <div class="hero p-2 mb-3 d-flex gap-2">
      <button id="tabLogin"     class="tab-btn btn flex-fill active">Iniciar sesi√≥n</button>
      <button id="tabRegister"  class="tab-btn btn flex-fill">Registrarse</button>
      <button id="tabRecover"   class="tab-btn btn flex-fill">Recuperar contrase√±a</button>
    </div>

    <!-- Contenido -->
    <div class="hero p-4">
      <!-- LOGIN -->
      <form id="formLogin" class="row g-3">
        <div class="col-12">
          <label for="loginEmail" class="form-label">Correo electr√≥nico</label>
          <input type="email" class="form-control" id="loginEmail" placeholder="tu@correo.com" required>
        </div>
        <div class="col-12">
          <label for="loginPass" class="form-label">Contrase√±a</label>
          <input type="password" class="form-control" id="loginPass" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
        </div>
        <div class="col-12 d-grid">
          <button class="btn btn-success" type="submit">Entrar</button>
        </div>
      </form>

      <!-- REGISTER -->
      <form id="formRegister" class="row g-3 d-none">
        <div class="col-12">
          <label for="regName" class="form-label">Nombre completo</label>
          <input type="text" class="form-control" id="regName" placeholder="Nonna Maria" required>
        </div>
        <div class="col-12">
          <label for="regEmail" class="form-label">Correo electr√≥nico</label>
          <input type="email" class="form-control" id="regEmail" placeholder="nonna@nonnapastas.cl" required>
        </div>
        <div class="col-md-6">
          <label for="regPass" class="form-label">Contrase√±a</label>
          <input type="password" class="form-control" id="regPass" placeholder="M√≠nimo 8 caracteres" minlength="8" required>
        </div>
        <div class="col-md-6">
          <label for="regPass2" class="form-label">Repetir contrase√±a</label>
          <input type="password" class="form-control" id="regPass2" placeholder="Repite tu contrase√±a" minlength="8" required>
        </div>
        <div class="col-12 d-grid">
          <button class="btn btn-success" type="submit">Crear cuenta</button>
        </div>
      </form>

      <!-- RECOVER -->
      <form id="formRecover" class="row g-3 d-none">
        <div class="col-12">
          <label for="recEmail" class="form-label">Correo registrado</label>
          <input type="email" class="form-control" id="recEmail" placeholder="tu@correo.com" required>
        </div>
        <div class="col-12 d-grid">
          <button class="btn btn-danger" type="submit">Enviar enlace de recuperaci√≥n</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Footer con contacto -->
  <footer>
    <div class="container text-center">
      <p class="fw-bold mb-1">üçù Pastas Nonna</p>
      <p class="mb-0 small text-muted">Propietaria: Nonna Maria Rossi</p>
      <p class="mb-0 small text-muted">üìû +56 9 5555 1234</p>
      <p class="small text-muted">üìß contacto@nonnapastas.cl</p>
      <div class="flag mt-3"></div>
    </div>
  </footer>

  <!-- Toasts -->
  <div id="toastArea"></div>

  <script>
    // ---------- Tabs ----------
    const tabLogin    = document.getElementById('tabLogin');
    const tabRegister = document.getElementById('tabRegister');
    const tabRecover  = document.getElementById('tabRecover');
    const formLogin   = document.getElementById('formLogin');
    const formRegister= document.getElementById('formRegister');
    const formRecover = document.getElementById('formRecover');

    function setTab(active){
      [tabLogin,tabRegister,tabRecover].forEach(b=>b.classList.remove('active'));
      [formLogin,formRegister,formRecover].forEach(f=>f.classList.add('d-none'));

      if(active==='login'){ tabLogin.classList.add('active'); formLogin.classList.remove('d-none'); }
      if(active==='register'){ tabRegister.classList.add('active'); formRegister.classList.remove('d-none'); }
      if(active==='recover'){ tabRecover.classList.add('active'); formRecover.classList.remove('d-none'); }
    }
    tabLogin.onclick   = ()=>setTab('login');
    tabRegister.onclick= ()=>setTab('register');
    tabRecover.onclick = ()=>setTab('recover');

    // ---------- "Base de datos" en localStorage ----------
    const USERS_KEY = 'usuarios_nonnapastas';
    const getUsers = () => JSON.parse(localStorage.getItem(USERS_KEY)||'[]');
    const setUsers = (u) => localStorage.setItem(USERS_KEY, JSON.stringify(u));

    // ---------- Toasts ----------
    function toast(msg, variant='primary'){
      const wrap = document.getElementById('toastArea');
      const el = document.createElement('div');
      el.className = `toast align-items-center text-bg-${variant} border-0 show mb-2`;
      el.innerHTML = `<div class="d-flex">
        <div class="toast-body">${msg}</div>
        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
      </div>`;
      wrap.appendChild(el);
      setTimeout(()=>el.remove(), 2800);
    }

    // ---------- Registro ----------
    formRegister.addEventListener('submit', (e)=>{
      e.preventDefault();
      const name  = document.getElementById('regName').value.trim();
      const email = document.getElementById('regEmail').value.trim().toLowerCase();
      const pass  = document.getElementById('regPass').value;
      const pass2 = document.getElementById('regPass2').value;

      if(pass !== pass2){ toast('Las contrase√±as no coinciden','danger'); return; }

      const users = getUsers();
      if(users.some(u=>u.email===email)){ toast('El correo ya est√° registrado','warning'); return; }

      users.push({name,email,pass});
      setUsers(users);
      toast('Cuenta creada con √©xito','success');
      setTab('login');
      formRegister.reset();
    });

    // ---------- Login ----------
    formLogin.addEventListener('submit', (e)=>{
      e.preventDefault();
      const email = document.getElementById('loginEmail').value.trim().toLowerCase();
      const pass  = document.getElementById('loginPass').value;

      const users = getUsers();
      const match = users.find(u=>u.email===email && u.pass===pass);
      if(match){
        toast(`¬°Bienvenido/a, ${match.name}!`,'success');
        // Simulado: podr√≠as redirigir si quieres
        // setTimeout(()=>location.href='catalogo.html', 800);
      }else{
        toast('Credenciales inv√°lidas','danger');
      }
      formLogin.reset();
    });

    // ---------- Recuperar ----------
    formRecover.addEventListener('submit', (e)=>{
      e.preventDefault();
      const email = document.getElementById('recEmail').value.trim().toLowerCase();
      const users = getUsers();
      if(users.some(u=>u.email===email)){
        toast('Te enviamos un enlace de recuperaci√≥n (simulado)','primary');
      }else{
        toast('Ese correo no est√° registrado','warning');
      }
      formRecover.reset();
    });
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
